"use strict";(self.webpackChunkjira=self.webpackChunkjira||[]).push([[99],{9926:function(e,n,t){t.d(n,{A_:function(){return E},BA:function(){return s},LK:function(){return m},OP:function(){return d},RW:function(){return f},et:function(){return p},wE:function(){return v}});var r=t(9439),i=t(2791),a=t(7689),u=t(5850),o=t(6691),c=t(456),l=t(1652),d=function(){var e,n=null===(e=(0,a.TH)().pathname.match(/projects\/(\d+)/))||void 0===e?void 0:e[1];return Number(n)},s=function(){return(0,o.Y$)(d())},m=function(){return{projectId:d()}},f=function(){return["kanbans",m()]},p=function(){var e=d(),n=(0,l.A)(["name","typeId","processorId","tagId"]),t=(0,r.Z)(n,1)[0],a=(0,u.Nr)(t.name,300);return(0,i.useMemo)((function(){return{projectId:e,typeId:Number(t.typeId)||void 0,processorId:Number(t.processorId)||void 0,tagId:Number(t.tagId)||void 0,name:a||void 0}}),[t,e,a])},v=function(){return["tasks",p()]},E=function(){var e=(0,l.A)(["editingTaskId"]),n=(0,r.Z)(e,2),t=n[0].editingTaskId,a=n[1],u=(0,c.gK)(Number(t)),o=u.data,d=u.isLoading;return{editingTask:o,editingTaskId:t,startEdit:(0,i.useCallback)((function(e){a({editingTaskId:e})}),[a]),close:(0,i.useCallback)((function(){a({editingTaskId:""})}),[a]),isLoading:d}}},99:function(e,n,t){t.r(n),t.d(n,{Container:function(){return K},default:function(){return R}});var r,i,a,u,o=t(168),c=t(6499),l=t(5786),d=t(2791),s=t(7689),m=t(1087),f=t(9439),p=t(5728),v=t(9926),E=t(286),k=t(1933),Z=t(1582),h=t(5572),g=t(7309),b=t(8792),y=t(7892),I=t.n(y),T=t(456),P=function(){return{projectId:(0,v.OP)()}},w=function(){return["epics",P()]},C=t(4165),x=t(1413),M=t(5861),j=t(2643),Y=t(43),O=t(4183),A=t(2759),L=t(4086),D=function(e){var n=function(e){var n=(0,E.i)();return(0,k.useMutation)((function(e){return n("epics",{data:e,method:"POST"})}),(0,Z.HZ)(e))}(w()),t=n.mutate,r=n.isLoading,i=n.error,a=(0,L.Z)(),u=(0,f.Z)(a,1)[0],o=(0,v.OP)(),c=function(){var n=(0,M.Z)((0,C.Z)().mark((function n(r){return(0,C.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t((0,x.Z)((0,x.Z)({},r),{},{projectId:o}));case 2:e.onClose();case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return(0,d.useEffect)((function(){u.resetFields()}),[u,e.visible]),d.createElement(j.Z,{open:e.visible,onClose:e.onClose,forceRender:!0,destroyOnClose:!0,width:"100%"},d.createElement(N,null,r?d.createElement(Y.Z,{size:"large"}):d.createElement(d.Fragment,null,d.createElement("h1",null,"\u521b\u5efa\u4efb\u52a1\u7ec4"),d.createElement(p.Tv,{error:i}),d.createElement(O.Z,{form:u,layout:"vertical",style:{width:"40rem"},onFinish:c},d.createElement(O.Z.Item,{label:"\u540d\u79f0",name:"name",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u4efb\u52a1\u7ec4\u540d"}]},d.createElement(A.Z,{placeholder:"\u8bf7\u8f93\u5165\u4efb\u52a1\u7ec4\u540d\u79f0"})),d.createElement(O.Z.Item,{style:{textAlign:"right"}},d.createElement(g.ZP,{loading:r,type:"primary",htmlType:"submit"},"\u63d0\u4ea4"))))))},N=c.Z.div(r||(r=(0,o.Z)(["\n  height: 80vh;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n"]))),F=function(){var e=(0,v.BA)().data,n=function(e){var n=(0,E.i)();return(0,k.useQuery)(["epics",e],(function(){return n("epics",{data:e})}))}(P()).data,t=(0,T.Xi)({projectId:null===e||void 0===e?void 0:e.id}).data,r=function(e){var n=(0,E.i)();return(0,k.useMutation)((function(e){var t=e.id;return n("epics/".concat(t),{method:"DELETE"})}),(0,Z.kd)(e))}(w()).mutate,i=(0,d.useState)(!1),a=(0,f.Z)(i,2),u=a[0],o=a[1];return d.createElement(p.X_,null,d.createElement(p.X2,{bettween:!0},d.createElement("h1",null,null===e||void 0===e?void 0:e.name,"\u4efb\u52a1\u7ec4"),d.createElement(g.ZP,{onClick:function(){return o(!0)},type:"link"},"\u521b\u5efa\u4efb\u52a1\u7ec4")),d.createElement(b.ZP,{style:{overflow:"scroll"},dataSource:n,itemLayout:"vertical",renderItem:function(n){return d.createElement(b.ZP.Item,null,d.createElement(b.ZP.Item.Meta,{title:d.createElement(p.X2,{bettween:!0},d.createElement("span",null,n.name),d.createElement(g.ZP,{onClick:function(){return function(e){h.Z.confirm({title:"\u786e\u5b9a\u5220\u9664\u9879\u76ee\u7ec4\uff1a".concat(e.name),content:"\u70b9\u51fb\u786e\u5b9a\u5220\u9664",okText:"\u786e\u5b9a",onOk:function(){r({id:e.id})}})}(n)},type:"link"},"\u5220\u9664")),description:d.createElement("div",null,d.createElement("div",null,"\u5f00\u59cb\u65f6\u95f4\uff1a",I()(n.start).format("YYYY-MM-DD")),d.createElement("div",null,"\u7ed3\u675f\u65f6\u95f4\uff1a",I()(n.end).format("YYYY-MM-DD")))}),d.createElement("div",null,null===t||void 0===t?void 0:t.filter((function(e){return e.epicId===n.id})).map((function(n){return d.createElement(m.rU,{to:"/projects/".concat(null===e||void 0===e?void 0:e.id,"/kanban?editingTaskId=").concat(n.id),key:n.id},n.name)}))))}}),d.createElement(D,{onClose:function(){return o(!1)},visible:u}))},H=d.lazy((function(){return Promise.all([t.e(292),t.e(934)]).then(t.bind(t,9934))})),S=[{path:"",element:d.createElement(s.Fg,{to:"kanban",replace:!0})},{path:"kanban",element:d.createElement(H,null)},{path:"epic",element:d.createElement(F,null)}],X=(0,d.memo)((function(){return d.createElement(K,null,d.createElement(B,null,d.createElement(l.Z,{mode:"inline",selectedKeys:[function(){var e=(0,s.TH)().pathname.split("/");return e[e.length-1]}()]},d.createElement(l.Z.Item,{key:"kanban"},d.createElement(m.rU,{to:"kanban"},"\u770b\u677f")),d.createElement(l.Z.Item,{key:"epic"},d.createElement(m.rU,{to:"epic"},"\u4efb\u52a1\u7ec4")))),d.createElement(Q,null,(0,s.V$)(S)))})),K=c.Z.div(i||(i=(0,o.Z)(["\n  display: grid;\n  grid-template-columns: 16rem 1fr;\n  width: 100%;\n"]))),B=c.Z.aside(a||(a=(0,o.Z)(["\n  background-color: rgb(244, 245, 247);\n  display: flex;\n"]))),Q=c.Z.div(u||(u=(0,o.Z)(["\n  display: flex;\n  box-shadow: -5px 0 5px -5px rgba(0, 0, 0, 0.1);\n  overflow: hidden;\n"]))),R=X},456:function(e,n,t){t.d(n,{Fq:function(){return l},G1:function(){return d},G8:function(){return c},Wi:function(){return s},Xi:function(){return u},gK:function(){return o}});var r=t(1933),i=t(286),a=t(1582),u=function(e){var n=(0,i.i)();return(0,r.useQuery)(["tasks",e],(function(){return n("tasks",{data:e})}))},o=function(e){var n=(0,i.i)();return(0,r.useQuery)(["tasks",{id:e}],(function(){return n("tasks/".concat(e))}),{enabled:Boolean(e)})},c=function(e){var n=(0,i.i)();return(0,r.useMutation)((function(e){return n("tasks",{method:"POST",data:e})}),(0,a.HZ)(e))},l=function(e){var n=(0,i.i)();return(0,r.useMutation)((function(e){var t=e.id;return n("tasks/".concat(t),{method:"DELETE"})}),(0,a.kd)(e))},d=function(e){var n=(0,i.i)();return(0,r.useMutation)((function(e){return n("tasks/".concat(e.id),{method:"PATCH",data:e})}),(0,a.k1)(e))},s=function(e){var n=(0,i.i)();return(0,r.useMutation)((function(e){return n("tasks/reorder",{data:e,method:"POST"})}),(0,a.R5)(e))}}}]);
//# sourceMappingURL=99.f4e3055f.chunk.js.map